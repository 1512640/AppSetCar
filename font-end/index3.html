<!DOCTYPE html>
<html>
<head>
    <title>APP #3</title>
    <meta charset="utf-8">
</head>
<body>
    <ul id="list"></ul>
    <script id="template" type="text/x-handlebars-template">
        {{#each this}}
            <li>{{name}}</li>
            <li>{{addr}}</li>
            <li>{{sdt}}</li>
        {{/each}}
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script type="text/javascript">
        ts = 0;

        window.onload = function() {
            loadCategories();
        }

        var loadCategories = function() {
            var url = 'http://localhost:3000/categories?ts=' + ts;
            axios.get(url)
                .then(function(res) {
                    ts = res.data.return_ts;
                    var source = document.getElementById('template').innerHTML;
                    var template = Handlebars.compile(source);
                    var html = template(res.data.categories);
                    document.getElementById('list').innerHTML += html;
                }).catch(function(err) {
                    console.log(err);
                }).then(function() {
                    setTimeout(loadCategories, 3500);
                })
        }
    </script>
</body>
</html>